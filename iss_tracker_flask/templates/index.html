<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ISS Tracker</title>
    <link rel="icon" href="{{ url_for('static', filename='images/favicon.png') }}">



    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">

    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/examples/js/controls/OrbitControls.js"></script>

    <style>
        body {
            background: #f4f8ff;
            font-family: "Segoe UI", Arial, sans-serif;
        }

        .jumbotron {
            background: linear-gradient(135deg, #007bff, #f29010ff);
            color: white;
            padding: 3rem 2rem;
            margin-bottom: 2rem;
            border-radius: 0;
        }

        #map {
            height: 500px;
            width: 100%;
            border-radius: 10px;
        }

        #earth3d {
            width: 100%;
            height: 400px;
            min-height: 400px;
        }

        footer {
            margin-top: 40px;
            padding: 25px;
            background: #111;
            color: white;
        }
    </style>
</head>

<body>

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <a class="navbar-brand" href="#">ISS Tracker</a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarContent">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarContent">
        <ul class="navbar-nav ml-auto">
            <li class="nav-item active"><a class="nav-link" href="#">Home</a></li>
            <li class="nav-item"><a class="nav-link" href="#about-section">About</a></li>
            <li class="nav-item">
                <a class="nav-link" href="https://www.nasa.gov/spot-the-station/" target="_blank">
                    Spot The Station
                </a>
            </li>
        </ul>
    </div>
</nav>

<!-- HEADER -->
<div class="jumbotron text-center">
    <h1 class="display-4">üõ∞Ô∏è ISS LIVE TRACKER üöÄ</h1>
    <p class="lead">Real-time location, crew information, and more.</p>
</div>


<!-- 3D EARTH SCRIPT (ONLY ONE) -->
<script>
const container = document.getElementById("earth3d");

function createEarth() {
    const width = container.clientWidth;
    const height = 400;

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(50, width / height, 0.1, 1000);
    camera.position.set(0, 0, 2.5);

    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(width, height);
    container.innerHTML = "";
    container.appendChild(renderer.domElement);

    const controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.enableZoom = false;

    const loader = new THREE.TextureLoader();
    loader.load(
        "https://raw.githubusercontent.com/Chandu487/earthtextures/main/earth_daymap.jpg",
        function (texture) {
            const earth = new THREE.Mesh(
                new THREE.SphereGeometry(1, 64, 64),
                new THREE.MeshStandardMaterial({ map: texture })
            );
            scene.add(earth);

            const light = new THREE.PointLight(0xffffff, 1.2);
            light.position.set(5, 3, 5);
            scene.add(light);

            function animate() {
                requestAnimationFrame(animate);
                earth.rotation.y += 0.0015;
                renderer.render(scene, camera);
            }
            animate();
        }
    );
}

createEarth();
</script>

<!-- MAIN CONTENT -->
<div class="container mb-5">

    <!-- CREW CARD -->
    <div class="card shadow-sm mb-4">
        <div class="card-body">
            <h3 class="card-title text-primary">Astronauts Aboard the ISS</h3>
            <p class="text-secondary">Currently <strong>12</strong> astronauts:</p>

            <ul class="list-group mb-3">
                <li class="list-group-item"><strong>Oleg Kononenko</strong></li>
                <li class="list-group-item"><strong>Nikolai Chub</strong></li>
                <li class="list-group-item"><strong>Tracy Caldwell Dyson</strong></li>
                <li class="list-group-item"><strong>Matthew Dominick</strong></li>
                <li class="list-group-item"><strong>Michael Barratt</strong></li>
                <li class="list-group-item"><strong>Jeanette Epps</strong></li>
                <li class="list-group-item"><strong>Alexander Grebenkin</strong></li>
                <li class="list-group-item"><strong>Butch Wilmore</strong></li>
                <li class="list-group-item"><strong>Sunita Williams</strong></li>
                <li class="list-group-item"><strong>Li Guangsu</strong></li>
                <li class="list-group-item"><strong>Li Cong</strong></li>
                <li class="list-group-item"><strong>Ye Guangfu</strong></li>
            </ul>

            <h5>Your Approximate Location:</h5>
            <p><strong>Latitude:</strong> 39.0437</p>
            <p><strong>Longitude:</strong> -77.4875</p>
        </div>
    </div>

    <!-- MAP CARD -->
    <div class="card shadow-sm">
        <div class="card-body">
            <h4 class="text-primary mb-3">Live ISS Position</h4>
            <div id="map"></div>
        </div>
    </div>
</div>

<!-- MAP SCRIPT -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
    const map = L.map('map').setView([0, 0], 2);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '¬© OpenStreetMap contributors'
    }).addTo(map);

    const issIcon = L.icon({
        iconUrl: 'https://upload.wikimedia.org/wikipedia/commons/d/d0/International_Space_Station.svg',
        iconSize: [50, 32],
        iconAnchor: [25, 16]
    });

    const issMarker = L.marker([0, 0], { icon: issIcon }).addTo(map);

    async function updateISS() {
        const res = await fetch('/iss');
        const data = await res.json();
        issMarker.setLatLng([data.latitude, data.longitude]);
        map.panTo([data.latitude, data.longitude]);
    }

    updateISS();
    setInterval(updateISS, 5000);
</script>

<!-- ABOUT -->
<div id="about-section" class="container mt-5 mb-5">
    <div class="card shadow-sm">
        <div class="card-body">
            <h3 class="text-primary">About This Project</h3>
            <p>
                This ISS Tracker shows the ISS in real time using ISS API data.
                It also displays astronauts currently aboard and your approximate location.
            </p>
        </div>
    </div>
</div>

<!-- FOOTER -->
<footer class="text-center">
    <p>Want to see the ISS from your location?</p>
    <a class="btn btn-outline-info" href="https://www.nasa.gov/spot-the-station/" target="_blank">
        Spot The Station
    </a>
    <p class="mt-3">¬© 2025 ISS Tracker</p>
</footer>

</body>
</html>

